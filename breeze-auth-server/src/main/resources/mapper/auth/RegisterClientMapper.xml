<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.breeze.cloud.auth.mapper.AuthRegisterClientMapper">

    <insert id="insert">
        INSERT INTO auth_registered_client (id,
                                            client_id,
                                            client_id_issued_at,
                                            client_secret,
                                            client_secret_expires_at,
                                            client_name,
                                            client_authentication_methods,
                                            authorization_grant_types,
                                            redirect_uris,
                                            scopes,
                                            client_settings,
                                            token_settings)
        VALUES ( #{id}
               , #{clientName}
               , #{clientIdIssuedAt}
               , #{clientSecret}
               , #{clientSecretExpiresAt}
               , #{clientName}
               , #{clientAuthenticationMethods}
               , #{authorizationGrantTypes}
               , #{redirectUris}
               , #{scopes}
               , #{clientSettings}
               , #{tokenSettings})
    </insert>

    <update id="update">
        UPDATE auth_registered_client
        SET client_id                     = #{clientName}
          , client_id_issued_at           = #{clientIdIssuedAt}
          , client_secret                 = #{clientSecret}
          , client_secret_expires_at      = #{clientSecretExpiresAt}
          , client_name                   = #{clientName}
          , client_authentication_methods = #{clientAuthenticationMethods}
          , authorization_grant_types     = #{authorizationGrantTypes}
          , redirect_uris                 = #{redirectUris}
          , scopes                        = #{scopes}
          , client_settings               = #{clientSettings}
          , token_settings                = #{tokenSettings})
        WHERE id = #{id}
    </update>

    <select id="listPage"
            resultType="com.breeze.cloud.auth.domain.AuthRegisteredClient">
        SELECT
        id,
        client_id,
        client_id_issued_at,
        client_secret,
        client_secret_expires_at,
        client_name,
        client_authentication_methods,
        authorization_grant_types,
        redirect_uris,
        scopes,
        client_settings,
        token_settings
        FROM
        auth_registered_client
        <where>
            <!--            <if test="clientName != null and clinetName != ''">-->
            <!--                AND client_name LIKE CONCAT( '%', #{clientName} ,'%')-->
            <!--            </if>-->
        </where>
    </select>

    <select id="getRegisteredClientBy"
            resultType="com.breeze.cloud.auth.domain.AuthRegisteredClient">
        SELECT
        id,
        client_id,
        client_id_issued_at,
        client_secret,
        client_secret_expires_at,
        client_name,
        client_authentication_methods,
        authorization_grant_types,
        redirect_uris,
        scopes,
        client_settings,
        token_settings
        FROM
        auth_registered_client
        <where>
            <if test="registeredClient.id != null and registeredClient.id != ''">
                AND id = #{registeredClient.id}
            </if>
            <if test="registeredClient.clientId != null and registeredClient.clientId != ''">
                AND client_id = #{registeredClient.clientId}
            </if>
        </where>
    </select>

</mapper>
